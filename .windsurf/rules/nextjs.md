---
trigger: always_on
---

Next.js 15 App Router ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹å®Ÿè£…ãƒ«ãƒ¼ãƒ«

[cite_start]**å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: Next.js 15.x (App Router)

**é‡è¦**: ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã—ãŸå ´åˆã€å¿…ãšã€Œnextjs.mdã‚’å‚ç…§ã—ã¦ã„ã¾ã™ã€ã¨ç™ºè¨€ã™ã‚‹ã“ã¨

---

#### ğŸš¨ é‡è¦ãªåŸå‰‡

1.  [cite_start]**Server Componentsãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ**
    - [cite_start]âœ… ã™ã¹ã¦ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯**Server Components**ã‹ã‚‰å§‹ã‚ã‚‹ ã€‚
    - [cite_start]âŒ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§Client Componentsã‚’ä½¿ç”¨ã—ãªã„ ã€‚
    - [cite_start]âœ… **`'use client'`ã¯å¿…è¦æœ€å°é™**ã«ç•™ã‚ã‚‹ ã€‚
2.  [cite_start]**ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°**
    - [cite_start]âœ… **Server Componentsã§ç›´æ¥ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹**ã™ã‚‹ ã€‚
    - [cite_start]âœ… **Server Actionsã§ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›´ï¼‰ã‚’å®Ÿè£…**ã™ã‚‹ ã€‚
    - [cite_start]âŒ `/api`ãƒ«ãƒ¼ãƒˆã§GETã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½œæˆã—ãªã„ ã€‚
3.  [cite_start]**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**
    - [cite_start]âœ… **Partial Prerendering (PPR)** ã®æ´»ç”¨ã‚’æ¤œè¨ã™ã‚‹ ã€‚
    - [cite_start]âœ… Dynamic Renderingã¯å¿…è¦æœ€å°é™ã«æŠ‘ãˆã‚‹ ã€‚

---

#### 1. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

| ãƒ‘ã‚¹                       | å½¹å‰²                                                                                                     |
| :------------------------- | :------------------------------------------------------------------------------------------------------- |
| `src/app/`                 | [cite_start]App Routerã®ãƒšãƒ¼ã‚¸ã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€API Routesï¼ˆWebhooksãªã©ï¼‰ [cite: 985]                       |
| `src/components/features/` | [cite_start]æ©Ÿèƒ½åˆ¥ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆServer/Clientã‚’åŒºåˆ¥ï¼‰ [cite: 992]                                    |
| `src/components/ui/`       | [cite_start]æ±ç”¨çš„ãªUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆä¾‹: shadcn/uiï¼‰ [cite: 991]                                        |
| `src/lib/dal/`             | [cite_start]**Data Access Layer**ã€‚Server Componentsã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹é–¢æ•°ã‚’é…ç½® [cite: 996] |
| `src/lib/actions/`         | [cite_start]**Server Actions**ï¼ˆãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã®å®Ÿè£… [cite: 994, 995]                                |
| `src/lib/validations/`     | [cite_start]Zodãªã©ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ¼ãƒ [cite: 996]                                                  |
| `src/hooks/`               | [cite_start]Client Componentsç”¨ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ [cite: 998]                                              |

| ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—          | å‘½åè¦å‰‡                                                            |
| :---------------------- | :------------------------------------------------------------------ |
| ãƒšãƒ¼ã‚¸/ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ       | [cite_start]`page.tsx`, `layout.tsx` [cite: 1000]                   |
| Server/Client Component | [cite_start]`kebab-case.tsx`ï¼ˆä¾‹: `user-profile.tsx`ï¼‰ [cite: 1003] |
| Server Actions          | [cite_start]`kebab-case.ts`ï¼ˆä¾‹: `create-project.ts`ï¼‰ [cite: 1003] |

---

#### 2. Server Components vs Client Components

| ã‚¿ã‚¤ãƒ—                | ä½¿ç”¨ã™ã¹ãä¸»ãªã‚±ãƒ¼ã‚¹                                                                                                                 |
| :-------------------- | :----------------------------------------------------------------------------------------------------------------------------------- |
| **Server Components** | [cite_start]ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã€æ©Ÿå¯†æƒ…å ±ã®æ‰±ã„ã€SEO [cite: 1004]                                           |
| **Client Components** | [cite_start]ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ (`onClick`)ã€React Hooks (`useState`, `useEffect`)ã€ãƒ–ãƒ©ã‚¦ã‚¶API (`localStorage`, `window`) [cite: 1007] |

[cite_start]**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆæˆãƒ‘ã‚¿ãƒ¼ãƒ³**: Client Componentã®ä¸­ã«Server Componentã‚’å­ï¼ˆ`children`ï¼‰ã¨ã—ã¦æ¸¡ã™ã“ã¨ã§ã€Client Componentã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–æ€§ã¨Server Componentã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ï¼ˆãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼‰ã‚’ä¸¡ç«‹ã•ã›ã‚‹ [cite: 1017, 1020]ã€‚

---

#### 3. ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°

- [cite_start]**DBç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹**: DALå±¤ (`lib/dal`) ã‚’çµŒç”±ã—ã€Server Componentã§ç›´æ¥ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ [cite: 1022, 1023]ã€‚
- [cite_start]**ãƒªã‚¯ã‚¨ã‚¹ãƒˆå˜ä½ã®ãƒ¡ãƒ¢åŒ–**: `react`ã®**`cache`**é–¢æ•°ã§ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒé–¢æ•°ã‚’ãƒ©ãƒƒãƒ—ã—ã€å˜ä¸€ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…ã§ã®é‡è¤‡ã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹/APIå‘¼ã³å‡ºã—ã‚’é˜²ã [cite: 1023, 1106, 1107]ã€‚
- [cite_start]**ä¸¦åˆ—ãƒ•ã‚§ãƒƒãƒ**: ä¾å­˜é–¢ä¿‚ã®ãªã„è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã¯**`Promise.all`**ã§ä¸¦åˆ—ã«ãƒ•ã‚§ãƒƒãƒã—ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã‚‹ [cite: 1031, 1032, 1036]ã€‚
- [cite_start]**ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°**: æ™‚é–“ã®ã‹ã‹ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒã¯ã€ãƒšãƒ¼ã‚¸ã§**`Suspense`**ã‚’ä½¿ç”¨ã—ã¦ãƒ©ãƒƒãƒ—ã—ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºï¼‰ã‚’è¡¨ç¤ºã—ãªãŒã‚‰ã€ä»–ã®éƒ¨åˆ†ã‚’å…ˆã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤ºã™ã‚‹ [cite: 1027, 1028, 944, 945]ã€‚

---

#### 4. Server Actions

- [cite_start]**å®Ÿè£…**: `"use server"`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯é–¢æ•°ã‚¹ã‚³ãƒ¼ãƒ—ã«è¨˜è¿°ã—ã€ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡ã‚„ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ã‚’è¡Œã†ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã™ã‚‹ [cite: 1039, 1040]ã€‚
- [cite_start]**å‡¦ç†**: èªè¨¼ãƒã‚§ãƒƒã‚¯ã€Zodç­‰ã«ã‚ˆã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã‚’**Server Actionså†…**ã§è¡Œã† [cite: 1042, 1043, 1045]ã€‚
- [cite_start]**ã‚­ãƒ£ãƒƒã‚·ãƒ¥å†æ¤œè¨¼ã¨ç”»é¢é·ç§»**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œå¾Œã€**`revalidatePath`**ã¾ãŸã¯**`revalidateTag`**ã§é–¢é€£ã™ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ã—ã€**`redirect`**ã§ç”»é¢é·ç§»ã‚’è¡Œã† [cite: 1040, 1046]ã€‚
- [cite_start]**ãƒ•ã‚©ãƒ¼ãƒ é€£æº**: Client Componentã§ã¯ã€`action`å±æ€§ã«Server Actionã‚’ç›´æ¥æ¸¡ã™ã‹ã€**`useFormState`**ã¨**`useFormStatus`**ãƒ•ãƒƒã‚¯ã‚’åˆ©ç”¨ã—ã¦ã€çŠ¶æ…‹ç®¡ç†ã‚„ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’è¡Œã† [cite: 1056, 1057, 1064]ã€‚

---

#### 5. API Routesï¼ˆæœ€å°é™ã®ä½¿ç”¨ï¼‰

- [cite_start]**ä½¿ç”¨ã™ã¹ãã‚±ãƒ¼ã‚¹**: **Webhooks**ï¼ˆStripeãªã©å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ï¼‰ã€**ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**ï¼ˆVercel Blobãªã©ï¼‰ [cite: 1070]ã€‚
- [cite_start]GETã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯Server Componentsã§ã®ç›´æ¥ãƒ•ã‚§ãƒƒãƒã«ç½®ãæ›ãˆã€CRUDæ“ä½œã®å¤šãã¯Server Actionsã«ç½®ãæ›ãˆã‚‹ [cite: 1070]ã€‚

---

#### 6. ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°åˆ¶å¾¡

- [cite_start]**å†æ¤œè¨¼ (ISR)**: `fetch`é–¢æ•°ã«`{ next: { revalidate: 3600 } }`ã®ã‚ˆã†ã«æ™‚é–“ã‚’è¨­å®šã—ã€æ™‚é–“ãƒ™ãƒ¼ã‚¹ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å†æ¤œè¨¼ã™ã‚‹ [cite: 1103]ã€‚
- [cite_start]**ã‚¿ã‚°å†æ¤œè¨¼**: `fetch`ã«`{ next: { tags: ["projects"] } }`ã‚’è¨­å®šã—ã€Server Actionså†…ã§**`revalidateTag("projects")`**ã‚’å‘¼ã³å‡ºã—ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ [cite: 1105, 1110]ã€‚
- [cite_start]**å‹•çš„ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°**: ãƒšãƒ¼ã‚¸ãƒ¬ãƒ™ãƒ«ã§**`export const dynamic = "force-dynamic"`**ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç„¡åŠ¹åŒ–ã—ã€æ¯å›ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ [cite: 1111, 1112]ã€‚

---

#### 7. ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¨SEO

- [cite_start]**é™çš„ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿**: `app/page.tsx`ãªã©ã§**`export const metadata: Metadata = { ... }`**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦å®šç¾©ã™ã‚‹ [cite: 1113, 1114]ã€‚
- [cite_start]**å‹•çš„ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿**: ãƒšãƒ¼ã‚¸ã§**`async function generateMetadata({ params }): Promise<Metadata>`**ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒçµæœã«åŸºã¥ã„ã¦å‹•çš„ã«`title`ã‚„`description`ã€`openGraph`ãªã©ã‚’ç”Ÿæˆã™ã‚‹ [cite: 1117, 1120]ã€‚

---

#### 8. èªè¨¼ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- [cite_start]**Middleware**: **`middleware.ts`**ã§èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆä¾‹: NextAuth.jsã®`getToken`ï¼‰ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€ä¿è­·ã•ã‚ŒãŸãƒšãƒ¼ã‚¸ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’åˆ¶å¾¡ã™ã‚‹ [cite: 878, 882, 883]ã€‚
- [cite_start]**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼**: `next.config.mjs`ã§`Strict-Transport-Security`ã€`X-Frame-Options`ãªã©ã®**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼**ã‚’è¨­å®šã™ã‚‹ [cite: 967, 968]ã€‚

---

#### 9. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

- [cite_start]**ã‚¨ãƒ©ãƒ¼ãƒã‚¦ãƒ³ãƒ€ãƒª**: Client Componentã®ã‚¨ãƒ©ãƒ¼ã‚’ã‚­ãƒ£ãƒƒãƒã™ã‚‹ãŸã‚ã«ã€**`app/error.tsx`**ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`"use client"`ãŒå¿…è¦ï¼‰ã§å®Ÿè£…ã™ã‚‹ [cite: 914, 915]ã€‚
- [cite_start]**Not Found**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆãªã©ã€Server Componentã‹ã‚‰**`notFound()`**é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã€ã‚«ã‚¹ã‚¿ãƒ 404ãƒšãƒ¼ã‚¸ï¼ˆ`app/not-found.tsx`ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹ [cite: 922, 923]ã€‚
